import React, { useRef, useState, useEffect } from 'react';
import { useMedplum } from '../MedplumProvider/MedplumProvider.mjs';
import { createScriptTag } from '../utils/script.mjs';

function GoogleButton(props) {
    const medplum = useMedplum();
    const { googleClientId, handleGoogleCredential } = props;
    const parentRef = useRef(null);
    const [scriptLoaded, setScriptLoaded] = useState(typeof google !== 'undefined');
    const [initialized, setInitialized] = useState(false);
    const [buttonRendered, setButtonRendered] = useState(false);
    useEffect(() => {
        if (typeof google === 'undefined') {
            createScriptTag('https://accounts.google.com/gsi/client', () => setScriptLoaded(true));
            return;
        }
        if (!initialized) {
            google.accounts.id.initialize({
                client_id: googleClientId,
                callback: handleGoogleCredential,
            });
            setInitialized(true);
        }
        if (parentRef.current && !buttonRendered) {
            google.accounts.id.renderButton(parentRef.current, {});
            setButtonRendered(true);
        }
    }, [medplum, googleClientId, initialized, scriptLoaded, parentRef, buttonRendered, handleGoogleCredential]);
    if (!googleClientId) {
        return null;
    }
    return React.createElement("div", { ref: parentRef });
}
function getGoogleClientId(clientId) {
    if (clientId) {
        return clientId;
    }
    const origin = window.location.protocol + '//' + window.location.host;
    const authorizedOrigins = "http://localhost:3000,http://127.0.0.1:3000,http://localhost:6006,http://127.0.0.1:6006,https://app.medplum.com,https://docs.medplum.com,https://storybook.medplum.com,https://graphiql.medplum.com,https://www.medplum.com"?.split(',') ?? [];
    if (authorizedOrigins.includes(origin)) {
        return "921088377005-3j1sa10vr6hj86jgmdfh2l53v3mp7lfi.apps.googleusercontent.com";
    }
    return undefined;
}

export { GoogleButton, getGoogleClientId };
//# sourceMappingURL=GoogleButton.mjs.map
