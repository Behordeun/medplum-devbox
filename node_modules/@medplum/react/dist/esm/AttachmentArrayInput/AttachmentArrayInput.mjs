import { ActionIcon } from '@mantine/core';
import { IconCircleMinus, IconCloudUpload } from '@tabler/icons';
import React, { useState, useRef } from 'react';
import { AttachmentButton } from '../AttachmentButton/AttachmentButton.mjs';
import { AttachmentDisplay } from '../AttachmentDisplay/AttachmentDisplay.mjs';
import { killEvent } from '../utils/dom.mjs';

function AttachmentArrayInput(props) {
    const [values, setValues] = useState(props.defaultValue ?? []);
    const valuesRef = useRef();
    valuesRef.current = values;
    function setValuesWrapper(newValues) {
        setValues(newValues);
        if (props.onChange) {
            props.onChange(newValues);
        }
    }
    return (React.createElement("table", { style: { width: '100%' } },
        React.createElement("colgroup", null,
            React.createElement("col", { width: "97%" }),
            React.createElement("col", { width: "3%" })),
        React.createElement("tbody", null,
            values.map((v, index) => (React.createElement("tr", { key: `${index}-${values.length}` },
                React.createElement("td", null,
                    React.createElement(AttachmentDisplay, { value: v, maxWidth: 200 })),
                React.createElement("td", null,
                    React.createElement(ActionIcon, { title: "Remove", size: "sm", onClick: (e) => {
                            killEvent(e);
                            const copy = values.slice();
                            copy.splice(index, 1);
                            setValuesWrapper(copy);
                        } },
                        React.createElement(IconCircleMinus, null)))))),
            React.createElement("tr", null,
                React.createElement("td", null),
                React.createElement("td", null,
                    React.createElement(AttachmentButton, { onUpload: (attachment) => {
                            setValuesWrapper([...valuesRef.current, attachment]);
                        } }, (props) => (React.createElement(ActionIcon, { ...props, title: "Add", size: "sm", color: "green" },
                        React.createElement(IconCloudUpload, { size: 16 })))))))));
}

export { AttachmentArrayInput };
//# sourceMappingURL=AttachmentArrayInput.mjs.map
